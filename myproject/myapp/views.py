from django.shortcuts import render
from .scan import sql_injection_scan
from .port_scan import scan_ports

def combined_view(request):
    result = None
    if request.method == "POST":
        action = request.POST.get("action")
        
        if action == "sql_injection":
            url = request.POST.get("sql_url")
            if url:
                result = sql_injection_scan(url)
        
        elif action == "port_scan":
            target = request.POST.get("target")
            start_port = int(request.POST.get("start_port"))
            end_port = int(request.POST.get("end_port"))
            if target and start_port and end_port:
                result = scan_ports(target, start_port, end_port)

    return render(request, "myapp/Index.html", {"result": result})